---
title: 线程封闭
date: 2018-09-03 17:50:14
tags:
---

# 线程封闭方法

1. Ad-hoc线程封闭
程序控制实现， 最糟糕， 忽略
2. 堆栈封闭： 局部变量，每个线程访问方法时都会各自拷贝局部变量，无并发问题

3. ThreadLocal线程封闭： 每个thread线程内部都有一个map， 以线程本地对象作为key， 以线程的变量副本作为value。 map由threadlocal维护。 由threadlocal设置map的变量值， 获取值。 别的线程获取不到当前线程的副本值。

4. JDBC的connection对象， connection对象返回连接池之前， 连接池不会将它分配给别的线程。connection对象本身不安全。