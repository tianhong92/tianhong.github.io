---
title: 线程安全性-有序性
date: 2018-09-02 10:30:53
tags:
---

# 有序性

java内存模型， 允许编译器和处理器对指令重排序， 重排序结果不会影响单线程执行， 却会影响到多线程并发执行的正确性。

synchronized, lock同一时间只允许一个线程执行同步代码， 让线程们顺序执行当然保证了有序性

volatile也能保证一定的有序性


## Happens-before原则

JMM先天的有序性（不需要通过任何手段就能保证的有序性）
 * 程序次序原则， 代码按书写次序执行（适用于单线程， 逻辑上看是按次序执行的， 因为有重排序）
 * 锁定原则， unlock先行发生于lock
 * volatile变量规则， 对一个变量的写操作先行发生于读操作
 * 传递规则
 。。。 
 后面的4条都很显而易见	